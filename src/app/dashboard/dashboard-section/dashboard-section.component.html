<main>
  <app-search-bar
    [placeholder]="'Dashboard'"
    (searchOutputEventEmit)="searchResult($event)"
  ></app-search-bar>

  <hr />

  <!--  list item view here -->
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <h1>Similar Accounts</h1>
        <mat-progress-bar
          mode="indeterminate"
          *ngIf="progressBar"
        ></mat-progress-bar>
        <div class="row">
          <ng-container *ngFor="let accountData of accountSearchData">
            <div class="col-md-6 my-2">
              <div class="row">
                <div class="col-md-2">
                  <img
                    [src]="accountData.logo || defaultLogo"
                    alt="img/png"
                    width="70"
                    height="70"
                    class="logo-image"
                  />
                </div>
                <div class="col-md-4 mt-3">
                  <b
                    ><span class="title">{{ accountData.company }}</span></b
                  >
                  <p class="website-link">{{ accountData.website }}</p>
                </div>
                <div class="col-md-4">
                  <!-- first Check normal track button -->

                  <ng-container
                    *ngIf="!accountData.isTracking; else trackingAccountData"
                  >
                    <ng-container
                      *ngTemplateOutlet="
                        buttonForTracking;
                        context: { data: accountData }
                      "
                    ></ng-container>
                  </ng-container>

                  <ng-template #trackingAccountData>
                    <ng-container
                      *ngTemplateOutlet="
                        buttonForTracking;
                        context: { data: accountData }
                      "
                    ></ng-container>
                  </ng-template>
                </div>
              </div>
            </div>
          </ng-container>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- For handling button tracking and un tracking system -->
<ng-template #buttonForTracking let-accountData="data">
  <button
    mat-stroked-button
    [color]="accountData.isTracking ? 'primary' : 'warn'"
    class="mt-2"
    (click)="trackAccountData(accountData)"
  >
    <div class="d-flex justify-content-space">
      <ng-container *ngIf="accountData.loading">
        <span class="mt-2 mx-2"
          ><mat-spinner [diameter]="15"></mat-spinner
        ></span>
      </ng-container>

      <span> {{ accountData.isTracking ? "TRACKING" : "TRACK" }}</span>
    </div>
  </button>
</ng-template>
